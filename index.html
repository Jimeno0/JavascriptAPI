<html>
<head>
	<title>Tutoriales</title>
	<style type="text/css">
		iframe{
			width: 100%;
			height: 400px;
			border: 1px solid #efefef;
		}
	</style>
</head>
<body>
	<div class="container">
		<div class="row">
			<div class="col-md-12">
				<h1 class="text-center">Tutoriales</h1>
			</div>
			<div class="col-md-6">
				<ul id="tutos">
				</ul>
			</div>
			
			<div class="col-md-6">
				<iframe id="preview" src="./src/tutoriales/tutorial_1.html"></iframe>
				<p><a href="https://github.com/esri-es/JavascriptAPI/blob/master/src/tutoriales/tutorial_1.html" id="code" class="btn btn-block btn-primary" style="margin-top:1em" target="blank">Ver c√≥digo</a></p>
			</div>
		</div>
	</div>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">

	<!-- Optional theme -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">

	<!-- Latest compiled and minified JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
	
	<script>
		$.getJSON("https://api.github.com/repos/esri-es/JavascriptAPI/contents/src/tutoriales", function(data){
			//debugger
			data.forEach(function(elem){
				//debugger
				if(elem.name.indexOf(".html") !== -1){
					$.get("./"+elem.path, function(html){
						var name = getTitle(html);
						$("<li data-name='"+name+"'><a href='./"+elem.path+"' onclick='preview(\"./"+elem.path+"\",\""+elem.html_url+"\");return false;'>"+name+"</a></li>").appendTo("#tutos");
						
						

					});
					

				}
			}
			);
			setTimeout(function(){
			var $tutos = $('#tutos'),
				$tutosli = $tutos.children('li');

			$tutosli.sort(function(a,b){
				var an = a.getAttribute('data-name').split(":")[0],
					bn = b.getAttribute('data-name').split(":")[0];
					console.log("an=",an)
				if(an > bn) {
					return 1;
				}
				if(an < bn) {
					return -1;
				}
				return 0;
			});

			$tutosli.detach().appendTo($tutos);
		}, 1000);

			
		});
		var preview = function(url, html_url){
			$("#preview").attr("src",url);
			$("#code").attr("href",html_url);
			
			return -1;
		};

		

		function getTitle(html) {
		  return (html.replace( /<!\[CDATA\[(.+?)\]\]>/g
		                      , function (_match, body) {
		                          return body.replace(/&/g, '&amp;')
		                                     .replace(/</g, '&lt;')
		                                     .replace(/>/g, '&gt;')
		                        } )
		              .replace(/<!--.+?-->/g, '')
		              .match(/<title>.+?<\/title>/ig) || [])
		              .map(function (t) { return t.substring(7, t.length - 8) })
		              .join(' ')
		}


	</script>
</body>
</html>

<!-- http://rawgit.com/showdownjs/showdown/master/dist/showdown.js -->
